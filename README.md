# Deepfake Detection ‚Äî ML Intensive Yandex Academy (Autumn 2025)

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ **–±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª–∏—Ü**  
(**Real vs Deepfake**) –≤ —Ä–∞–º–∫–∞—Ö ML Intensive Yandex Academy (–æ—Å–µ–Ω—å 2025).

üéØ **–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å *—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é* –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (–±–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π), —Å–ø–æ—Å–æ–±–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å –¥–∏–ø—Ñ–µ–π–∫–∏ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –Ω–∞ **Recall** (–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∏–ø—Ñ–µ–π–∫–æ–≤).

---

## üß† –û–±—â–∞—è –∏–¥–µ—è —Ä–µ—à–µ–Ω–∏—è

–í —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –º—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ **–¥–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞**, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –≥–∏–ø–æ—Ç–µ–∑–∞—Ö –æ –ø—Ä–∏—Ä–æ–¥–µ –¥–∏–ø—Ñ–µ–π–∫–æ–≤:

1. **DeepFakeNet (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)**  
   –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è residual-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –∏ –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—é recall.

2. **Artifact-Sensitive HRNet (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)**  
   –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –ø–æ–∏—Å–∫ –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (GAN artifacts).

–ü–æ –∏—Ç–æ–≥–∞–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ **–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∞ –ø–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å (DeepFakeNet)** ‚Äî –∏–º–µ–Ω–Ω–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `submission.csv`.

---

## ü•á –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å: DeepFakeNet

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
DeepFakeNet ‚Äî –∫–∞—Å—Ç–æ–º–Ω–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Å –Ω—É–ª—è:

- **Stem-–±–ª–æ–∫** —Å –Ω–∞—á–∞–ª—å–Ω—ã–º downsampling  
- **4 residual-—É—Ä–æ–≤–Ω—è** —Å —Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–∞ –∫–∞–Ω–∞–ª–æ–≤: 32 ‚Üí 64 ‚Üí 128 ‚Üí 256
- **Residual connections** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è **SiLU**
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è **–¥–≤—É—Ö —Ç–∏–ø–æ–≤ pooling**:
- Global Average Pooling
- Adaptive Context Pooling
- –§–∏–Ω–∞–ª—å–Ω—ã–π **classification head** —Å Dropout

üìå –¢–∞–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ **–≥–ª–æ–±–∞–ª—å–Ω—É—é –≥–µ–æ–º–µ—Ç—Ä–∏—é –ª–∏—Ü–∞**, —Ç–∞–∫ –∏ **–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**.

---

## ‚öñÔ∏è –†–∞–±–æ—Ç–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤

–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ ‚âà **5:1 (Real : Fake)**.

–ú—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –º–µ—Ç–æ–¥–æ–≤:

- **WeightedRandomSampler**  
‚Üí —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞—Ç—á–∏ (50% / 50%)
- **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**:
0.6 √ó BCEWithLogitsLoss (—Å –≤–µ—Å–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤)
0.4 √ó Focal Loss (Œ≥ = 2)

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –∏ –ø–æ–≤—ã—Å–∏—Ç—å Recall –¥–ª—è –∫–ª–∞—Å—Å–∞ *Fake*.

---

## üèãÔ∏è –û–±—É—á–µ–Ω–∏–µ

### –≠—Ç–∞–ø 1 ‚Äî –û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- **88% train / 12% val** (stratified split)
- 20 —ç–ø–æ—Ö
- Batch size: 16
- Optimizer: **AdamW**
- LR: `1e-4`, Weight decay: `1e-4`
- Scheduler: **ReduceLROnPlateau**

### –≠—Ç–∞–ø 2 ‚Äî Fine-tuning
- –û–±—É—á–µ–Ω–∏–µ –Ω–∞ **100% –¥–∞–Ω–Ω—ã—Ö**
- LR: `5e-5`
- 5 —ç–ø–æ—Ö

üìà Fine-tuning —Å –º–∞–ª—ã–º learning rate —É–ª—É—á—à–∏–ª –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

---

## üéØ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–í–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ `0.5` –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–æ—Ä–æ–≥–∞**:

- –ü–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ö—Ä–∏—Ç–µ—Ä–∏–π: **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π F1-score**
- –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç **Recall**

üìå –≠—Ç–æ –¥–∞–ª–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –∏—Ç–æ–≥–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –∏ –ª—É—á—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–∏–ø—Ñ–µ–π–∫–æ–≤.

---

## üñºÔ∏è –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### Train
- `RandomResizedCrop` (80‚Äì100%)
- `RandomHorizontalFlip`
- `ColorJitter`
- `GaussianBlur` (p = 0.3)

### Validation / Test
- Resize –¥–æ `256√ó256`
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (ImageNet stats)

---

## üß™ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å: Artifact-Sensitive HRNet

### –ì–∏–ø–æ—Ç–µ–∑–∞
GAN (–≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ StyleGAN) –æ—Å—Ç–∞–≤–ª—è—é—Ç **–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã**:
- checkerboard patterns
- —à—É–º –∞–ø—Å–µ–º–ø–ª–∏–Ω–≥–∞

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ CNN —Å —Ä–∞–Ω–Ω–∏–º pooling‚Äô–æ–º —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏.

### –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏
- **RandomAdjustSharpness** –≤–º–µ—Å—Ç–æ blur  
‚Üí —É—Å–∏–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **No-Pooling Stem**  
‚Üí Strided Convolutions –≤–º–µ—Å—Ç–æ MaxPool
- **–ö–∞—Å—Ç–æ–º–Ω–∞—è HRNet**  
‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ high-resolution –≤–µ—Ç–∫–∏ –Ω–∞ –≤—Å–µ–π –≥–ª—É–±–∏–Ω–µ —Å–µ—Ç–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | Best Val F1 | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------------|-------------|-------------|
| Custom ResNet | ~0.65 | –ü–æ—Ç–µ—Ä—è –¥–µ—Ç–∞–ª–µ–π |
| RGB + FFT | ~0.60 | –®—É–º–Ω–∞—è –º–æ–¥–µ–ª—å |
| **Custom HRNet** | **~0.80** | –õ—É—á—à–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |

üìå –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫–∏–π F1, –º–æ–¥–µ–ª—å –æ–∫–∞–∑–∞–ª–∞—Å—å –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ —Ö—É–∂–µ –æ–±–æ–±—â–∞–ª–∞—Å—å, —á–µ–º DeepFakeNet.

---

## üì¶ –ò—Ç–æ–≥–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

- `best_model.pth` ‚Äî –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏  
- `best_model_finetuned.pth` ‚Äî –≤–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ fine-tuning  
- `submission.csv` ‚Äî **—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DeepFakeNet**

---

## üîë –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã

- Residual-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è **BCE + Focal Loss** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∫–∞–∂–¥–æ–π –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥** —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ª—É—á—à–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- Fine-tuning —Å –º–∞–ª—ã–º LR –ø–æ–≤—ã—à–∞–µ—Ç –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã GAN –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## ‚ôªÔ∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

- –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã —Å `seed = 42`
- –ö–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–Ω–∞–±–∂–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- –†–µ—à–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –Ω–∞ GPU (CUDA)

---

üöÄ **–§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–∏–ø—Ñ–µ–π–∫–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫–∏–π Recall –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–º F1-score, —á—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–¥–∞—á–∏.**
